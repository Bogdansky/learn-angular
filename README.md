# LearnAngular

This application is generated by Angular CLI and is supposed to be used for my Angular learning path.

## Features

### User Profile Form with Multi-Step Wizard
A comprehensive form with three steps:
1. **General Information** - Name, surname, middle name, date of birth, gender
2. **Addresses** - Dynamic address management with add/remove functionality
3. **Employment History** - Dynamic employment records with mutual exclusivity for current employment

### Custom Directives

#### MutuallyExclusiveCheckbox Directive

A reusable directive that implements mutual exclusivity for checkboxes within a FormArray, ensuring only one checkbox can be selected at a time.

##### **Usage**

```html
<mat-checkbox 
  formControlName="isStillEmployed" 
  appMutuallyExclusiveCheckbox
  [formArray]="employmentHistoryFormArray"
  controlName="isStillEmployed"
  relatedControlName="dateOfEnd">
  Still working for this employer
</mat-checkbox>
```

##### **How It Works**

**1. Core Functionality**
- Ensures only one checkbox in a FormArray can be checked at any time
- When a checkbox is checked, all other checkboxes in the same group become disabled
- When a checkbox is unchecked, other checkboxes become enabled again (if no other checkbox is checked)

**2. Inputs**
- `formArray`: The FormArray containing all the form groups with checkboxes
- `controlName`: The name of the checkbox control within each form group (e.g., "isStillEmployed")
- `relatedControlName` (optional): Name of a related control to manage (e.g., "dateOfEnd")

**3. Related Control Management**
When `relatedControlName` is specified, the directive automatically:
- **Disables and clears** the related control when checkbox is checked
- **Enables and adds validators** to the related control when checkbox is unchecked

**4. Technical Implementation**

```typescript
// Key features:
- Uses NgControl injection to get the current FormControl
- Subscribes to valueChanges with { emitEvent: false } to prevent infinite loops
- Manages FormControl state (enable/disable) programmatically
- Handles cleanup with proper subscription management
```

**5. State Management Flow**

```
User checks checkbox → 
├── Disable all other checkboxes in FormArray
├── Clear and disable related control (if specified)
└── Update validators accordingly

User unchecks checkbox →
├── Check if any other checkbox is still checked
├── If none checked: enable all checkboxes
├── Enable related control (if specified)
└── Add required validators to related control
```

**6. Benefits**
- **Reusable**: Can be applied to any FormArray with checkbox controls
- **Declarative**: Clear intent in template with directive attributes
- **Memory Safe**: Proper subscription cleanup in ngOnDestroy
- **Loop Prevention**: Uses `{ emitEvent: false }` to prevent cascade events
- **Flexible**: Optional related control management

**7. Real-world Use Case**
In the employment history form, this directive ensures:
- Only one employment can be marked as "current"
- When an employment is current, the end date is automatically cleared and disabled
- When no employment is current, end dates become required fields

This pattern is commonly needed for:
- Radio button-like behavior with checkboxes
- Primary/default selection scenarios
- Conditional form field management

##### **Example Implementation**

```typescript
// In your component:
export class MyComponent {
  formArray = this.fb.array([
    this.fb.group({
      name: ['Company A'],
      isActive: [false],
      endDate: ['', Validators.required]
    }),
    this.fb.group({
      name: ['Company B'], 
      isActive: [false],
      endDate: ['', Validators.required]
    })
  ]);
}
```

```html
<!-- In your template: -->
<div formArrayName="companies">
  <div *ngFor="let company of formArray.controls; let i = index" [formGroupName]="i">
    <input formControlName="name">
    <mat-checkbox 
      formControlName="isActive"
      appMutuallyExclusiveCheckbox
      [formArray]="formArray"
      controlName="isActive"
      relatedControlName="endDate">
      Currently Active
    </mat-checkbox>
    <input formControlName="endDate" [disabled]="company.get('isActive')?.value">
  </div>
</div>
```
